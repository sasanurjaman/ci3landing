<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');class Sim_model extends CI_Model {	function access($u = 'null', $c = '*', $p = 'read')	{		$query = $this->db->query('select user.'.$c.' as col from user where userid = "'.$u.'"');		if ($query->num_rows() > 0) {			$row = $query->row();			$acc = explode("|", $row->col);			switch ($p) {				case 'new':					return $acc[1];					break;				case 'edit':					return $acc[2];					break;				case 'delete':					return $acc[3];					break;				case 'print':					return $acc[4];					break;				default:				   return $acc[0];			}		} 		else 		{			return false;		}	}		function data()	{		$query = $this->db->query('SELECT logo, nama, moto, bagian, subagian, kota, kodepos, alamat, telepon, fax, email, format, ukuran, autorefresh FROM perusahaan WHERE id = 1');		if ($query->num_rows() > 0) 		{			return $query->row();		} 		else 		{			return false;		}	}	    function remove_format($nmr)    {        return filter_var($nmr, FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION);    }        function code_format()     {		$this->db->select('nomor, year(tanggal) AS tahun, month(tanggal) AS bulan');        $this->db->order_by('id', 'desc');        $query = $this->db->get('pinjaman');        $row = $query->row();        $year = ($query->num_rows() > 0 ? $row->tahun : date('Y'));        $month = ($query->num_rows() > 0 ? sprintf("%02d", $row->bulan) : date('m'));                    if ($year == date('Y') && (int)$month < (int)date('m'))        {            $number = $year.$month.'01';        }        elseif ((int)$year < (int)date('Y'))        {            $number = $year.$month.'01';        }        else        {            $code = ($query->num_rows() > 0 ? $row->nomor : $year.$month.'00');            $angka = null;            $huruf = null;            for ($n = (strlen($code)-1); $n >= 0 ; $n--)            {                if (preg_match('/^[0-9]+$/', substr($code, $n, 1)))                    $angka = substr($code, $n, 1).$angka;                else                     break;            }            $huruf = substr($code, 0, ($n+1));                    $number = $huruf.sprintf("%0".strlen($angka)."d", $angka+1);        }                return $number;    }    	//*** konversi nama bulan manual ***//	function m2ina() 	{		$nmbl = array (			"January"    => "Januari",			"February"   => "Februari",			"March"      => "Maret",			"April"      => "April",			"May"        => "Mei",			"June"       => "Juni",			"July"       => "Juli", 			"August"     => "Agustus",			"September"  => "September",			"October"    => "Oktober", 			"November"   => "November",			"December"   => "Desember");		return $nmbl[date("F")];	}		//*** konversi nama hari manual ***//	function d2ina() 	{		$nmhr = array (			"Sunday"    => "Minggu",			"Monday"    => "Senin",			"Tuesday"   => "Selasa",			"Wednesday" => "Rabu",			"Thursday"  => "Kamis",			"Friday"    => "Jumat",			"Saturday"  => "Sabtu");		return $nmhr[date("l")];	}		//*** safe tag html dan karaktek khusus ***\\	function savehtml($str) 	{		$str = str_replace("&", "-AMP-", $str);		$str = str_replace("<", "-LT-", $str);		$str = str_replace(">", "-GT-", $str);		$str = str_replace("'", "-APOS-", $str);		$str = str_replace("\"", "-QUOT-", $str);		$str = str_replace("/", "-FRASL-", $str);		$str = str_replace("\\", "-#92-", $str);		$str = str_replace("|", "-#124-", $str);		return $str;	}	//*** restore tag html dan karaktek khusus ***\\	function restorehtml($str) 	{		$str = str_replace("-AMP-", "&amp;", $str);		$str = str_replace("-LT-", "&lt;", $str);		$str = str_replace("-GT-", "&gt", $str);		$str = str_replace("-APOS-", "&apos;", $str);		$str = str_replace("-QUOT-", "&quot;", $str);		$str = str_replace("-FRASL-", "&frasl;", $str);		$str = str_replace("-#92-", "&#92;", $str);		$str = str_replace("-#124-", "&#124;", $str);		return $str;	}        function aktifitas($log = null)	{		//get id		$qid= $this->db->query('SELECT MAX(id) AS id FROM aktifitas'); $maxid = $qid->row();		$id = ($qid->num_rows() > 0 ? $maxid->id + 1 : 1);				$this->db->query('INSERT INTO aktifitas (id, waktu, alamat, pengguna, keterangan) VALUES ('.		'"'.$id.'", '.		'"'.date("Y-m-d H:i:s").'", '.		'"'.$_SERVER['REMOTE_ADDR'].'", '.		'"'.$this->session->userdata('SESS_USER_ID').'", '.		'"'.$log.'")');		}}/* End of file sim_model.php *//* Location: ./application/models/sim_model.php */